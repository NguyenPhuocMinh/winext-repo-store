### Installation

Install the dependencies and devDependencies and start the server.

```sh
$ npm install winrow
```

In Node.js:
```js
const server = require('winrow');
// Get ProtoTypes In Server.
const {
  Promise,
  lodash,
  moment,
  returnCodes,
  dataMongoose,
  validator
} = server;

// Services

function ExampleServices() {
  // create services
  this.exampleCreate = function(args, opts) {
    const { loggingFactory, requestId } = opts;
    loggingFactory.debug('create begin', {requestId : `${requestId}`})
    return dataMongoose.create({
      type : 'name of model'
      data : {} || args
    })
    .then(result => '...do something then return result')
    .catch(err => {
      loggingFactory.error('create begin', {requestId : `${requestId}`})
      return Promise.reject(err);
    })
  }
  // get services
  this.exampleGet = function(args, opts) {
    const { loggingFactory } = opts;
    return dataMongoose.find({
      type : 'name of model',
      filter : {} || 'query with field model',
      projection : {} || 'get field in model',
      options : {} || 'pagination mongoose',
      populates : [
        {
          path : 'field of reference in model',
          select : 'get field in model of reference'
        }
      ]
    })
    .then(result => '... do something')
  }
  // get by id servers
  this.exampleGetById = function(args, opts) {
    const { loggingFactory } = opts;
    return dataMongoose.get({
      type : 'name of model',
      id : args.id,
      populates : [
        {
          path : 'field of reference in model',
          select : 'get field in model of reference'
        }
      ]
    })
    .then(result => '...do something')
  }
  // update server
  this.exampleUpdate = function(args, opts) {
    const { loggingFactory } = opts;
    return dataMongoose.update({
      type : 'name of model',
      id : args.id,
      data : {} || args
    })
    .then(result => '...do something')
  }
}

// mappings 

const mappings = [
  // create
  {
    path : '/example',
    method : 'POST',
    methodName : 'exampleCreate',
    serviceName : ExampleServices,
    input : {
      transform : function(req) {
        // schema 
        const schema = {
          type: 'object',
          properties: {
            name: { type: 'string' },
          },
          required: ['name']
        }
        // validate request
        const {valid, errors} = validator(schema, req.body);
        if(!valid) {
          return Promise.reject(errors);
        }
        return {
          name : req.body.name
        }
      }
    },
    output: {
      transform: function (response) {
        return {
          body: response
        }
      }
    }
  },
  // get
   {
    pathName: '/example',
    method: 'GET',
    methodName: 'exampleGet',
    serviceName: ExampleServices,
    input: {
      transform: function (req) {
        return {
          params: req.query
        }
      }
    },
    output: {
      transform: function (response) {
        return {
          headers: {
            'X-Total-Count': response.total,
            'Access-Control-Expose-Headers': 'X-Total-Count'
          },
          body: response.data
        }
      }
    }
  },
  // get by id
  {
    pathName: '/example/:id',
    method: 'GET',
    methodName: 'exampleGetById',
    serviceName: ExampleServices,
    input: {
      transform: function (req) {
        return {
          id: req.params.id
        }
      }
    },
    output: {
      transform: function (response) {
        return {
          body: response
        }
      }
    }
  },
  // update
   {
    pathName: '/example/:id',
    method: 'PUT',
    methodName: 'exampleUpdate',
    serviceName: ExampleServices,
    input: {
      transform: function (req) {
        return {
          id: req.params.id,
          ...req.body
        }
      }
    },
    output: {
      transform: function (response) {
        return {
          body: response
        }
      }
    }
  },
]

// method of dataMongoose
findOne({type, filter = {}, projection = {}, populates})
count({type, filter = {}})
create({type, data})
find({type, filter = {}, projection = {}, options = {}, populates})
get({type, id, projection= {}, populates})
update({type, id, data})
updateOne({type, id, data})
aggregate({type, pipeline})
deleted({type, id})

// Example Connect API
[git hub](https:github.com/NguyenPhuocMinh/example-node-api)
```